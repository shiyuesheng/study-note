# 随机IO、顺序IO

磁盘顺序读写、磁盘随机读写，寻址开销会消耗部分性能的

## 数据读取

表T中有一个聚簇索引(主键索引)IndexA、非聚簇索引(二级索引)IndexB。

因为MySQL的索引使用的是B+树，对于聚簇索引，数据存储在叶子结点，并且是顺序连续的；对于非聚簇索引，叶子结点存储的是聚簇索引的主键ID，也是顺序连续的。

例如：使用非聚簇索引进行范围查询时，首先找到起始的叶子结点，因为是顺序的，连续的，对应在磁盘上就是存储地址相连，集中分布在一个或几个数据⻚中，这种场景进行数据的读取是很快的，称之为顺序IO。

假设没有产生索引覆盖，那在非聚簇索引上查询到的所有数据(主键ID)都需要在聚簇索引上进行回表，去获取更为详细的数据。获取到的主键ID之间是没有太多的逻辑关联的，在聚簇索引上很大概率是不相连的，对应在磁盘上就是存储在不同的数据页中。想要读取全部的记录，就得访问更多的数据页，这种场景进心数据读取相对效率低下，称之为随机IO。

很多时候进行SQL优化，有些思路、方案就是围绕着减少随机IO进行的。

## 数据插入

如果你要执行2条insert语句，但是你的log file正好只能容纳一条，那么在写入磁盘的时候。只有一条可以执行，那么比如正好在磁盘6。过了一段时间在执行第二条语句，数据跑到了磁盘32的位置。这种操作是随机io。如果log file正好可以全部容纳2条语句，两条语句同时被刷新到硬盘。第一条在磁盘6，第二条在磁盘7。那么这就是顺序io。这是在插入的情况。









